{% extends 'base.html' %}

{% block content %}
<main id="main">
    <!-- Header -->
    <header id="header">
        <h1>Socialize</h1>
        
        {% if g.user %}
        <h4><a href="{{ url_for('socialize.profile')}}"> {{ g.user['username'] }} </a></h4>
        <ul class="icons">
            <li>
                <a href="{{ url_for('socialize.user_feed')}}"> Feed </a>
            </li>
            <li>
                <a href="{{ url_for('socialize.create') }}"> Create </a>
            </li>
            <li>
                <a href="{{ url_for('socialize.connection')}}"> Connect </a>
            </li>
            <li>
                <a href="{{ url_for('auth.logout') }}"> Logout </a>
            </li>
        </ul>
        {% else %}
        <ul class="icons">
            <li>
            <a href="{{ url_for('auth.login') }}"> Login </a>
            </li>
        </ul>
        {% endif %}
    </header>
    
    <!-- Content -->
    <section id="thumbnails">
        {% for post in posts %}
        <article>
            <a class="thumbnail" href="{{ url_for('static', filename='images/') }}{{ post['image_url'] }}" data-position="left center">
            <img
                src="{{ url_for('static', filename='images/') }}{{ post['image_url'] }}"
                alt="{{ post['image_caption'] }}"
            />
            </a>
            <h2>by {{ post['post_user_id'] }} on {{ post['created'].strftime('%Y-%m-%d') }}</h2>
            <p>{{ post['image_caption'] }}</p>

            <ul class="icons">
                <li>
                    <button
                      onclick="sendlike('{{ post['post_id'] }}/{{ post['post_user_id'] }}')"
                    >
                      <i class="fas fa-heart"></i>
                    </button>
                    <!-- <a 
                      href="/like/{{ post['post_id'] }}/{{ post['post_user_id'] }}/like"
                    >
                        <i class="fas fa-comment"></i>
                    </a> -->
                </li>
                <li>
                    <a href="/comment/{{ post['post_id'] }}/{{ post['post_user_id'] }}">
                        <i class="fas fa-comment"></i>
                    </a>
                </li>
                <li>
                    <a href="/comment/{{ post['post_id'] }}/{{ post['post_user_id'] }}">
                        <i class="fas fa-share"></i>
                    </a>
                </li>
            </ul>

        </article>
        {% endfor %}
    </section>
</main>

<!-- Scripts -->
<script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/browser.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/breakpoints.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/main.js') }}"></script>

<script>
function sendlike(semi_url) {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
            document.getElementById("demo").innerHTML = this.responseText;
        }
    };
    xhttp.open("GET", `/like/${semi_url}/like`, true);
    xhttp.send();
}
</script>
{% endblock content %}
